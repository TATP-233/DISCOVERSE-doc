"use strict";(self.webpackChunkdiscoverse_docs=self.webpackChunkdiscoverse_docs||[]).push([[9275],{2023:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>d,metadata:()=>a,toc:()=>r});const a=JSON.parse('{"id":"tutorials/imitation-learning/rdt","title":"RDT (Robotics Diffusion Transformer)","description":"RDT (Robotics Diffusion Transformer) \u662f\u4e00\u79cd\u7ed3\u5408\u6269\u6563\u6a21\u578b\u548cTransformer\u7684\u5927\u6a21\u578b\u65b9\u6cd5\uff0c\u652f\u6301\u591a\u4efb\u52a1\u7edf\u4e00\u5efa\u6a21\uff0c\u5177\u6709\u5f3a\u5927\u7684\u6cdb\u5316\u80fd\u529b\u3002","source":"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/tutorials/imitation-learning/rdt.md","sourceDirName":"tutorials/imitation-learning","slug":"/tutorials/imitation-learning/rdt","permalink":"/DISCOVERSE-doc/zh-Hans/docs/tutorials/imitation-learning/rdt","draft":false,"unlisted":false,"editUrl":"https://github.com/TATP-233/DISCOVERSE/tree/main/discoverse-docs/docs/tutorials/imitation-learning/rdt.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Diffusion Policy","permalink":"/DISCOVERSE-doc/zh-Hans/docs/tutorials/imitation-learning/dp"},"next":{"title":"OpenPI (Open-source Policy Interface)","permalink":"/DISCOVERSE-doc/zh-Hans/docs/tutorials/imitation-learning/openpi"}}');var s=i(4848),l=i(8453);const d={sidebar_position:5},t="RDT (Robotics Diffusion Transformer)",c={},r=[{value:"\ud83d\udcca \u6570\u636e\u683c\u5f0f\u8f6c\u6362",id:"-\u6570\u636e\u683c\u5f0f\u8f6c\u6362",level:2},{value:"\u8f6c\u6362\u547d\u4ee4",id:"\u8f6c\u6362\u547d\u4ee4",level:3},{value:"\u8f6c\u6362\u793a\u4f8b",id:"\u8f6c\u6362\u793a\u4f8b",level:4},{value:"\u6570\u636e\u79fb\u52a8",id:"\u6570\u636e\u79fb\u52a8",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b",level:4},{value:"\u6570\u636e\u76ee\u5f55\u7ed3\u6784",id:"\u6570\u636e\u76ee\u5f55\u7ed3\u6784",level:3},{value:"\ud83c\udf93 \u6a21\u578b\u8bad\u7ec3",id:"-\u6a21\u578b\u8bad\u7ec3",level:2},{value:"GPU\u8981\u6c42",id:"gpu\u8981\u6c42",level:3},{value:"\u73af\u5883\u5b89\u88c5",id:"\u73af\u5883\u5b89\u88c5",level:3},{value:"\u4e0b\u8f7d\u6a21\u578b",id:"\u4e0b\u8f7d\u6a21\u578b",level:3},{value:"\u751f\u6210language embedding",id:"\u751f\u6210language-embedding",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-1",level:4},{value:"\u914d\u7f6e\u6587\u4ef6",id:"\u914d\u7f6e\u6587\u4ef6",level:3},{value:"\u8bad\u7ec3\u5fae\u8c03",id:"\u8bad\u7ec3\u5fae\u8c03",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-2",level:4},{value:"\ud83d\ude80 \u7b56\u7565\u63a8\u7406",id:"-\u7b56\u7565\u63a8\u7406",level:2},{value:"\u63a8\u7406\u547d\u4ee4",id:"\u63a8\u7406\u547d\u4ee4",level:3},{value:"\u63a8\u7406\u793a\u4f8b",id:"\u63a8\u7406\u793a\u4f8b",level:4}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"rdt-robotics-diffusion-transformer",children:"RDT (Robotics Diffusion Transformer)"})}),"\n",(0,s.jsx)(n.p,{children:"RDT (Robotics Diffusion Transformer) \u662f\u4e00\u79cd\u7ed3\u5408\u6269\u6563\u6a21\u578b\u548cTransformer\u7684\u5927\u6a21\u578b\u65b9\u6cd5\uff0c\u652f\u6301\u591a\u4efb\u52a1\u7edf\u4e00\u5efa\u6a21\uff0c\u5177\u6709\u5f3a\u5927\u7684\u6cdb\u5316\u80fd\u529b\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"-\u6570\u636e\u683c\u5f0f\u8f6c\u6362",children:"\ud83d\udcca \u6570\u636e\u683c\u5f0f\u8f6c\u6362"}),"\n",(0,s.jsx)(n.h3,{id:"\u8f6c\u6362\u547d\u4ee4",children:"\u8f6c\u6362\u547d\u4ee4"}),"\n",(0,s.jsx)(n.p,{children:"\u5c06\u4eff\u771f\u91c7\u96c6\u7684\u539f\u59cb\u6570\u636e\u683c\u5f0f\u8f6c\u6362\u4e3aRDT\u7b97\u6cd5\u4e2d\u7528\u5230\u7684HDF5\u683c\u5f0f\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"python3 policies/act/data_process/raw_to_hdf5.py -md mujoco -dir data -tn ${task_name} -vn ${video_names}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u8f6c\u6362\u793a\u4f8b",children:"\u8f6c\u6362\u793a\u4f8b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# \u793a\u4f8b\u8f6c\u6362\npython3 policies/act/data_process/raw_to_hdf5.py -md mujoco -dir data -tn block_place -vn cam_0 cam_1\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u6570\u636e\u79fb\u52a8",children:"\u6570\u636e\u79fb\u52a8"}),"\n",(0,s.jsx)(n.p,{children:"\u5c06hdf5\u6587\u4ef6\u79fb\u52a8\u5230RDT\u9700\u8981\u7684\u5730\u5740\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"mv data/hdf5/${task_name} policies/RDT/training_data\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u793a\u4f8b",children:"\u793a\u4f8b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"mv data/hdf5/block_place policies/RDT/training_data\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u6570\u636e\u76ee\u5f55\u7ed3\u6784",children:"\u6570\u636e\u76ee\u5f55\u7ed3\u6784"}),"\n",(0,s.jsx)(n.p,{children:"\u5c06\u591a\u4e2a\u4efb\u52a1\u7684\u6570\u636e\u90fd\u653e\u5728training_data\uff0cRDT\u4f1a\u5728\u4e00\u4e2a\u6a21\u578b\u4e2d\u8bad\u7ec3\u591a\u4e2a\u4efb\u52a1\uff0c\u76ee\u5f55\u7ed3\u6784\u4e3a\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"training_data\n\u251c\u2500\u2500 instructions\n\u2502   \u251c\u2500\u2500 ${task_1}.json\n\u2502   \u251c\u2500\u2500 ${task_2}.json\n\u2502   \u251c\u2500\u2500 ...\n\u251c\u2500\u2500 ${task_1}\n\u2502   \u251c\u2500\u2500 instructions\n\u2502   \u2502   \u251c\u2500\u2500 lang_embed_0.pt\n\u2502   \u2502   \u251c\u2500\u2500 ...\n\u2502   \u251c\u2500\u2500 episode_0.hdf5\n\u2502   \u251c\u2500\u2500 episode_1.hdf5\n\u2502   \u251c\u2500\u2500 ...\n\u251c\u2500\u2500 ${task_2}\n\u2502   \u251c\u2500\u2500 instructions\n\u2502   \u2502   \u251c\u2500\u2500 lang_embed_0.pt\n\u2502   \u2502   \u251c\u2500\u2500 ...\n\u2502   \u251c\u2500\u2500 episode_0.hdf5\n\u2502   \u251c\u2500\u2500 episode_1.hdf5\n\u2502   \u251c\u2500\u2500 ...\n\u251c\u2500\u2500 ...\n"})}),"\n",(0,s.jsx)(n.h2,{id:"-\u6a21\u578b\u8bad\u7ec3",children:"\ud83c\udf93 \u6a21\u578b\u8bad\u7ec3"}),"\n",(0,s.jsx)(n.h3,{id:"gpu\u8981\u6c42",children:"GPU\u8981\u6c42"}),"\n",(0,s.jsx)(n.p,{children:"\u8bad\u7ec3\u81f3\u5c11\u9700\u898125G\u5185\u5b58\uff08batch size = 4\uff09\uff0c\u63a8\u7406\u9700\u89810.5G\u5185\u5b58"}),"\n",(0,s.jsx)(n.h3,{id:"\u73af\u5883\u5b89\u88c5",children:"\u73af\u5883\u5b89\u88c5"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"conda create -n rdt python=3.10.0\nconda activate rdt\ncd DISCOVERSE\npip install -r requirements.txt\npip install -e .\npip install torch==2.1.0 torchvision==0.16.0 packaging==24.0 ninja \npip install flash-attn==2.7.2.post1 --no-build-isolation\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5982\u679c\u5b89\u88c5flash-attn\u5931\u8d25\uff0c\u53ef\u4ee5\u4ece\u5b98\u65b9\u4e0b\u8f7d\u5bf9\u5e94\u7684.whl\u5b89\u88c5: ",(0,s.jsx)(n.a,{href:"https://github.com/Dao-AILab/flash-attention/releases",children:"https://github.com/Dao-AILab/flash-attention/releases"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# \u5b89\u88c5flash_attn-*.whl:\npip install flash_attn-*.whl\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd DISCOVERSE/policies/RDT\npip install -r requirements.txt\npip install huggingface_hub==0.25.2\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u4e0b\u8f7d\u6a21\u578b",children:"\u4e0b\u8f7d\u6a21\u578b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd DISCOVERSE/policies/RDT\nmkdir -p weights/RDT && cd weights/RDT\nhuggingface-cli download google/t5-v1_1-xxl --local-dir t5-v1_1-xxl\nhuggingface-cli download google/siglip-so400m-patch14-384 --local-dir siglip-so400m-patch14-384\nhuggingface-cli download robotics-diffusion-transformer/rdt-1b --local-dir rdt-1b\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u751f\u6210language-embedding",children:"\u751f\u6210language embedding"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd DISCOVERSE\npython3 policies/RDT/scripts/encode_lang_batch_once.py ${task_name} ${gpu_id}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u793a\u4f8b-1",children:"\u793a\u4f8b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"python3 policies/RDT/scripts/encode_lang_batch_once.py block_place 0\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u914d\u7f6e\u6587\u4ef6",children:"\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,s.jsx)(n.p,{children:"\u590d\u5236policies/RDT/model_config/model_name.yml\uff0c\u5e76\u91cd\u547d\u540dmodel_name"}),"\n",(0,s.jsx)(n.h3,{id:"\u8bad\u7ec3\u5fae\u8c03",children:"\u8bad\u7ec3\u5fae\u8c03"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd DISCOVERSE/policies/RDT\npython3 scripts/encode_lang_batch_once.py {task_name} {gpu_id}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u793a\u4f8b-2",children:"\u793a\u4f8b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"python3 scripts/encode_lang_batch_once.py block_place 0\n"})}),"\n",(0,s.jsx)(n.h2,{id:"-\u7b56\u7565\u63a8\u7406",children:"\ud83d\ude80 \u7b56\u7565\u63a8\u7406"}),"\n",(0,s.jsx)(n.h3,{id:"\u63a8\u7406\u547d\u4ee4",children:"\u63a8\u7406\u547d\u4ee4"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd DISCOVERSE/policies/RDT\nbash eval.sh {robot} {task_name} {model_name} {ckpt_id}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"\u63a8\u7406\u793a\u4f8b",children:"\u63a8\u7406\u793a\u4f8b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"bash eval.sh airbot block_place model_name 20000\n"})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>d,x:()=>t});var a=i(6540);const s={},l=a.createContext(s);function d(e){const n=a.useContext(l);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),a.createElement(l.Provider,{value:n},e.children)}}}]);